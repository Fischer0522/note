# 计算机网络

## 概述

相关术语：

- 主机/端系统
- ISP：网络提供商
- RFC：标准文档，定义了一众协议
- 协议： 定义了通讯实体之间交换报文的格式和顺序，**语法、语义、时序、动作**
- 因特网：分布式应用以及为其提供服务的基础设施

**因特网**

- 网络边缘：位于网络边缘的端系统以及应用程序
- 网络核心：端系统分组交换机和链路构成的网络
- 接入网：将端系统物理连接到边缘路由器的网络

**交换方式：**

- 电路交换
  - 对所需的资源进行预留，分配好则他人不可使用，独占性
  - 对于同一条电路划分成不同的piece进行分配带宽
  - 复用方式：频分复用、时分复用
    - 频分复用：分配固定的频率（类比电台）
    - 时分复用：分配固定长度的帧和间隙
- 分组交换
  - 端系统之间相互交换的信息称为报文，报文划分成小的数据块则称为分组(包，packet)
  - 越过通信链路使用全部的带宽
  - 复用方式：按需划分成时间片，非固定长度
  - 存储转发传输：在不同的节点之间，需要先将分组完整的存储起来，然后再转发到下一个检点，在此期间产生了延迟。总延迟为存储过程中产生的延迟和物理传输过程中的延迟(距离/速度)
  - 转发：通过目标来查询路由器，获取下一次转发的路径

**延时：**处理延时，排队延时，传输延时(上载下载速度)，传播延时(物理传播)，

### 协议层次以及模型

通过协议分层，只需关注当前层如何功能，对于下面的层次，只需调用其API即可，无需关注实现方式，(类似 controller service dao三层架构)

**协议栈**：

- 应用层：网络应用程序以及相关协议存在的位置
- 传输层：通过传输协议(TCP/UDP)进行应用层报文的传输
- 网络层：IP协议传输数据报(datagram)
- 链路层：将分组再不同的节点之间传输(MAC)，链路层分组为帧
- 物理层：一个个bit的将数据进行传输，电信号，光信号表示01

**OSI七层模型**

多出了表示层和会话层

- 表示层：使通信的应用程序能够解释交换数据的含义
- 会话层：提供数据交换的定界和同步功能

**封装**

在将分组向下一层传输时，从上一次获取到有效负载(payload)，从在负载之前加上自己的首部字段

## 应用层

### 概述

应用层所运行的为应用程序以及其所支持的协议，如web项目，邮箱服务等以及所涉及的相关协议均运行在应用层之上

**体系结构**

- 客户端-服务器（C-S）
- P2P

**进程通信**

一个进程可认为是端系统上的一个程序，此处所说的进程通信为两个端系统之间的通信，通过交换报文的方式借助socket API，将报文下交给传输层，使用TCP/UDP进行传输

**定位方式**

一个进程对应着一个端口，通过主机IP+端口即可，具体绑定方式在传输层中讨论，对于应用层只需调用socket API即可

### 应用层协议

#### HTTP

- 定义了浏览器向服务器的请求方式，以及服务器做出相应，传递页面的方式

- 以tcp作为支撑

- 无状态协议
- 默认为持续连接，即创建tcp连接(三次握手)后保持该连接

**三次握手**

1. 客户端向服务器发送tcp报文段，
2. 服务器用tcp报文段确认并作出响应
3. 客户端向服务器返回确认

通过该三次握手，第二次握手服务端确认了客户端的发送能力，客户端接收到服务端的响应后确认了服务端的接收和发送能力，第三次握手服务器确认了客户端的接收和响应能力，从而客户端和服务端的发送和接收能力都得到确认，建立起完备的连接

**HTTP报文**

- 请求报文：

  - 请求行：方法字段 url字段 http版本字段

  - 首部行：host，user-agent等，F12抓包查看即可

    **![image-20220720233034070](计算机网络.assets/image-20220720233034070.png)**

    

- 响应报文

  - 初始状态行
  - 首部行
  - 实体

  ![image-20220720233107288](计算机网络.assets/image-20220720233107288.png)

  

 **C-S交互**

- cookie&session
- JWT

**Web缓存**

正向代理服务器，在客户端侧，客户端和代理服务器建立tcp连接后向代理服务器发送http请求，若代理服务器本地有，则直接返回给客户端即可，起到了缓存的效果，如果没有，再向目标服务器建立连接发送请求。

- 代理服务器位于局域网内，客户端与代理服务器之间比和原目标服务器速度要快
- 源目标服务器被访问次数减少，压力减小，响应速度变快



